<div class="m-4 p-6 min-h-screen">
  <h1 class="text-2xl font-semibold text-center mb-6">Product List</h1>

  <div class="overflow-x-auto">
    <table class="min-w-full bg-white rounded-lg shadow overflow-hidden">
      <thead class="bg-gray-100">
        <tr>
          <th class="px-4 py-2 text-left text-sm font-medium text-gray-600">
            Name
          </th>
          <th class="px-4 py-2 text-left text-sm font-medium text-gray-600">
            Flavor
          </th>
          <th class="px-4 py-2 text-right text-sm font-medium text-gray-600">
            Price
          </th>
          <th class="px-4 py-2 text-right text-sm font-medium text-gray-600">
            Stock
          </th>
          <th class="px-4 py-2 text-right text-sm font-medium text-gray-600">
            Sold
          </th>
          <th class="px-4 py-2 text-center text-sm font-medium text-gray-600">
            Actions
          </th>
        </tr>
      </thead>
      <tbody>
        @for (product of products; track product.id) {
        <tr class="border-b border-gray-200 even:bg-gray-50 hover:bg-gray-100">
          <td class="px-4 py-3 whitespace-nowrap">
            @if (editingProductId === product.id) {
            <input
              type="text"
              class="w-full px-3 py-1 rounded border border-gray-300"
              [(ngModel)]="product.name"
              name="name-{{ product.id }}"
            />
            } @else {
            <span class="text-gray-800">{{ product.name }}</span>
            }
          </td>

          <td class="px-4 py-3 whitespace-nowrap">
            @if (editingProductId === product.id) {
            <input
              type="text"
              class="w-full px-3 py-1 rounded border border-gray-300"
              [(ngModel)]="product.flavor"
              name="flavor-{{ product.id }}"
            />
            } @else {
            <span class="text-gray-600">{{ product.flavor }}</span>
            }
          </td>

          <td class="px-4 py-3 whitespace-nowrap text-right">
            @if (editingProductId === product.id) {
            <input
              type="number"
              class="w-24 px-3 py-1 rounded border border-gray-300 text-right"
              [(ngModel)]="product.price"
              name="price-{{ product.id }}"
              min="0"
            />
            } @else {
            <span class="text-gray-700">${{ product.price }}</span>
            }
          </td>

          <td class="px-4 py-3 whitespace-nowrap text-right">
            @if (editingProductId === product.id) {
            <input
              type="number"
              class="w-20 px-3 py-1 rounded border border-gray-300 text-right"
              [(ngModel)]="product.stock"
              name="stock-{{ product.id }}"
              min="0"
            />
            } @else {
            <span class="text-gray-700">{{ product.stock }}</span>
            }
          </td>

          <td class="px-4 py-3 whitespace-nowrap text-right">
            @if (editingProductId === product.id) {
            <input
              type="number"
              class="w-20 px-3 py-1 rounded border border-gray-300 text-right"
              [(ngModel)]="product.sold"
              name="sold-{{ product.id }}"
              min="0"
            />
            } @else {
            <span class="text-gray-700">{{ product.sold }}</span>
            }
          </td>

          <td class="px-4 py-3 whitespace-nowrap text-center space-x-2">
            @if (editingProductId === product.id) {
            <button
              class="bg-green-500 text-white px-3 py-1 rounded hover:bg-green-600 transition"
              (click)="saveEdit(product)"
            >
              Save
            </button>
            <button
              class="bg-gray-500 text-gray-700 px-3 py-1 rounded hover:bg-gray-600 transition"
              (click)="cancelEdit()"
            >
              Cancel
            </button>
            } @else {
            <button
              class="bg-yellow-600 text-white px-3 py-1 rounded hover:bg-yellow-700 transition"
              (click)="editProduct(product.id)"
            >
              Edit
            </button>
            <button
              class="bg-red-700 text-white px-3 py-1 rounded hover:bg-red-800 transition"
              (click)="deleteProduct(product.id)"
            >
              Delete
            </button>
            }
          </td>
        </tr>
        }
      </tbody>
    </table>
  </div>

  @if (showModal) {
  <app-product-modal (close)="onFormSubmit()" />
  }

  <div class="mt-6 text-right">
    <button
      class="bg-green-800 text-white px-5 py-2 rounded hover:bg-green-900 transition"
      (click)="showModal = true"
    >
      + Add Product
    </button>
  </div>
</div>
